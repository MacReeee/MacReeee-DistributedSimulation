package cryp

import (
	"encoding/json"
	"go.dedis.ch/kyber/v3/pairing"
	"os"

	"go.dedis.ch/kyber/v3/sign/bdn"
)

var (
	suite = pairing.NewSuiteBn256()
	sks   = []string{
		"436babacceaa0e985ce0b06321e50db789a5f9230b5ef3ffddc8ba64d2c896b8",
		"07ba027c422e35ac0b14794f858e924481e873fcb1771f9357e84055d37f580c",
		"80895cd18284111cb38a813c48b8533168b9adefe3ca5f8348261143391a5440",
		"7e079446464688b9f429ee9e6552e127ec413e3edffab7253b1475f7d79a7dc3",
		"6cdda21fb459d22b1616ebff6b90bbc3dc06303d4e9b20cf6f2c843947b340fd",
		"879a78528c8268ee4d4d230620bd74c34fd8568cfaffac15b2cbf30999994b1a",
		"63870376137ff9d1a81fdebc97585afec5c69d89b8171150919bea0e8a86f6c8",
		"2d8ee8b85557b1fd3796411f8c967245c6a5b42725aee9daac864cabe048c929",
		"1fee201786d30274c019dd49c469f532681336179932a278c58c31cca3513373",
		"1bd5284a44bcb26aed34846cf7173eb7093e5d633b5513006cc9bd76928ce500",
		"05f2b941c8379e51e128e696364358b30fb94f85053d848b392a852b16a2e6b5",
		"59d8eebda94a1f26786d533c33134c44dd3f6cc8740818d42b20f43d16029ce8",
		"459f44e04a35815062e1c0747b8a5b50e2c7584c6e4db97f319b617c41e785e7",
		"6410b3e3d95382360a2d0fbfd227d82ec197bbef99c60de138263a3738532c54",
		"610a11ad18913b3a0a0a056c1dcfb6783aeddd9c49ee114d4e3d061abe201d4d",
		"5c827a7ac657cd4a02a9b1e908e364e894b6da540c3b909730df3d26dbce9b61",
		"15863fd3e056f84c83f6e0a9558851f55582ff7454f5ff88a26e583ebe361439",
		"4965517f57c38ff720f7dce2b7cf75dde9807300f8c853108ae5cd2ed5662d96",
		"4f1e4eac0500f5b567140dea3eb798bd88fa2580b49fb6deeecfcf7b288e38d3",
		"7c4d6f86e290dd3d9b4ddb4aa5e7a27905b65d758d2b46f42660c3eb32954553",
		"786eed62e821df47ae93bf7b5c66d4ab1d30d98b1a7de610378f6ede1254cc40",
		"569ca3d009fec2443b61a13cda2c2fd4af4475d41e586c8019f05dacc44b9510",
		"0dc90d44d2f1b55b9d643e2740785d01321ab9c5ebf78b48682e861026d0c5c2",
		"5cac8d0919809ceef65e06c7ebcc3e5949bf928167515e26474a002bb334aece",
		"3c4f037735cad66800c0b0d46b26b73c5f61ace71bc0a190fd0022f639165287",
		"2c97f9cc86645e306e0bd81d57bcab0ad086fbbe3ee2f688bed888a351252dda",
		"7f6e02d99c77b14556c4b4c4ed31b0f1477192eb483d16da08aae63c10f04313",
		"45f92b3c3d7c54ef9a38c647810802504e3f69ccf9b8805acb938d732409d11b",
		"49641bd01aa8a69063a5c15e93898f1e0643a8d3f7d5e8d4ef3da29be399414a",
		"4a356c6f9644b3eb5884f685d9b3d3ae802d5d59dcec5f11b033bc8d0a079dcc",
		"601519f8a6b013affc4862e3fcfdc65d1f049fc53b50e7ee8fdd1ac4aa99dbc0",
		"76c0d8dae848a48e5d0b39c4697e4ddff730943b51ad7a235951b07ae2ed1269",
		"7e6913721beed638908ee5682c0d2921fd8f07817a82eb9824abdea66c556616",
		"8754623a322688f390e9a285995f8c0e8a76764f255b09034c4fbd4d0bcc5486",
		"662c03033bddaf4bec37ba0ebaab689477a5d0c231ad21d639a6a8d7cf5f941a",
		"50bf438699ef75b4dfa9edc0003bd485a205f7acdbf573203c68312f994a27a8",
		"4d77fe35ed47dfa3412c0f05e9aa871493f98a7358843fcf21e1c81b298a31a3",
		"774b3560a1fa48e028b9b22d2d69a89b1965e55ab4c5c987566651aead9428d9",
		"30f85c45a6153b0736b279cede5fc0269020e8b0cccfefc2aa623607a3fb25ef",
		"6428458387f3f059addbeb6120db1ec253e6967c45333a330fce7e679cc89e8c",
	}
	pks = []string{
		"4e5bfe782aa1ddcdf6480170aa710f4ea366ed63f8b711ebf32305fb254470a7633934ce2a3647b58850823cf32da712643afde19b79d24659b5d7d3148a837a4e0fc74c919d39dfad40e41db5df66dcefcf171c26dfb73c181f176d767fa0686702e9b146bcaf2b6905bff1e25dce2078052474f742bf8c42eaf707afdcb3b7",
		"235e29bd16ad97a7ad0ebfd603fd24646720c794ac3acfb5b44fda366a1cb5b878515255f5e6c4550c8652138ab4feedbfa75c6fdd317b9b1bbafd1eae6ddac21422825a80240d787101b93f14fd37bdb63fa8cd0488032f5c87e69f115fda2e5b66422dc4d164a6ff9de252d40c7cca04f51228abce7ff5df40300936452dd8",
		"390d71fa7a3882048041b3d4d96cfb570c0f844b1df3bd3e73115d969e09a42f6d09ffafe980b37b1b1cc976793813f9ea23e82f8000e5badd05d6e66f65631e30793cd8930af7c20909a94e82b190dff7bd5898ee6b864383991e888db9c08b5e8b6f517f5be6e313c1a74b51fabfb1e77cf65ea9e3ed9a834cdeaa101479f6",
		"1118bd064e4f8c40669afa951d8293e2f4a14e12f02a229b6b40f21bb82853d4087dbc712c1a2e22a4047e0f163aa6fb5815a2e0c28ef19755832ac5bc008d4d55959029010376624a00c3ec38fc60501ee16c7bec0459b7b74bb43c3271422a33418b1bc2c7d1770215c2cf65267b7a06947a7276df773cbc81dbc2c4d80938",
		"12d432a8fe2a57ac7aceaf67519ce80ed7f2ab1f9a1811dc2e94394a20d644003affd564337a543797ccf81f49bd051551adfc19bc62f3d2e1a2c3ea32f111a707031a0a5d2f08fa77d6c77eb58e8ed0e299969691153421d3b22aabd5c340720f45dbaee16330668454913bcd62be21895b6e1f86f4dc9698c302901b4a9b87",
		"35d58aa3ff7f8ddb46e5a1c42268f23dc6298e9cbf503dc20caab97e838e186e24318ab659133de1cb82ef8f72919a249529b9f01e840daeadd27b20b9de7b766de34a660dd09a3310ad2f96cb745f723627debced780923da166b8321a6a45e86fc66e2d68408af1abd6de86b9d4c14ba3a82e75de19e14b10ddf2e6ab2b9e2",
		"06e91e4c752aff38f82750bd797e071fa08861fb35cb079b3385a58535201c0e385e683f03d7d3506170b4b594d1cfc43988debc9103002b6759cc99f0241e6850173d7a23b3b28ae76f0d15ddc9c756cbc51e7b639cb23f921c0fd9ff0e5a8654127e259e5340c877260be46165f09e7de765c7cb0fb97a726827ca940e475a",
		"8317dfe0d2a6702037a4bffe4e062e3dcd4c3b78d633d0e48bf8295c0df263293bd67139e35b8dfdeb63790c14005c2da45993811b8fdd1527ca37be3fd2298f524dbea9e94883853eb7b15f677f52156089590b82171e2d23e026ff0bdc73d64a19878c8753ce3eafef54952115b60043a7deddeb19cccb9a0e3bc469d4cfb5",
		"6ad0ecd79fa0bfab9b757ded51ff9a3b0f75751f6ffd539ceff586c8ef7a336042ed2fd900674488d2b4e88d2e4f341d0deafc290e29b1aba90e2ab7e6abc63d58815136d77f67d134dccf6b21acd45753e0d0d0b75a1cbb86dcb430dcf5b26d825ef752a570f3af07d507b60324dd4423a1e9d818826838a66828ae598a9138",
		"47be4a0c90e9277f8bdd57faa7a747c918ca6543295ef3d4d90c378dc9576cb34759d345dd5b6a33b077a11c8d53acc52a412d277c508f6d28f5d9fe80239e485313f681de7e98dfb0f0869ebda39956fe49ceb65d913ff1ae348ef2f46c41e58564e3e27c36d89b2d34196ecf5988f5fe52c9ff5116898a08a3f94695e4a9bb",
		"6260a935c7f458c530222b3c459b657c211f8ef1bb7c148d4e4cefd0c5081aae5de8586c4477074fcd15da67c3038ad33afac425e52a8026fc831d1403a831773621e7881be1af3d5584a369d8f7eb3d5accab41c629a828ada047313f3dfa0d0587dfc2e6af65b7bc073295dfcb822a2e08905b419ee3a9ffd7aa77ac87b0bf",
		"49a056fe11f00ff5350089129a70f09d224379d53ec7386e4f67f9087836a41352b683fa9c680c1faad41543b6ab864541fd2f44789cbbb675eaf607ae39f3a722a716bd6d338df27b245ca6e1281264b73bee991e9f09153d7f34c424a347aa1fc2dce261954f22350d70798c30ee8a3a6f9f63eb23a99e44c0b5d0ee22e846",
		"6d22c055671c474b89ca7ed4d5caee6da1f3d4c06496ef3207c1dd17db7a35914f8156c9f3280a79636c0aec0486cf02e286d12f4bb1ca9ebfa9629f8a334e8a4920367234211f8fd96e2b6a6bd546b6f09ae0aa4acdfaf1386c3920985dac347582eea4fcda6c49c8cce8ab218c08ec14f5528115e9d8a635fdac03b8034739",
		"797b49d8a447f33302763f351cb3c681cecbcdf69d4f58b1f6745a392f6f689271c9155a3808a0dcdeee686486e3df607d97bee816ca33e3d12af03fd170af232f7b6ce25e85e09a903b5317ed8966936bcbf682a6499551941a8062ddd96b9f699308d362375210f034a69492845ce8c0fc1ac51630456c6ff8baecfddc11c8",
		"725efb9c97db1159d55e331f6e70d10cfc573dd1f36b2ffb45a457085759ebd523d13e90fc49854131eb409ed0b458574d62d200fedbdc4e9b123cbeee66470d133d0ddebf9e5464fc639def176dfec08cd65de7553dbe10f49ed44562a2b29155a8837b34faf5f058bb8dccbb8e6ae4359f4f64dc2f2c7a565b67e51af81fdb",
		"5de3cd4f45ecad7d2836b28adfae88fb23bdf9d2b58cca5c4571401c086844cd281deb45dbdfeb2ac4c08a6e6088f7364e9340a88821e272be36c89570498fef7ccecae740ab3c0bc2444922e596c7b9b98282b8fe71450c1487c5296934c5e82b8341b885c9361a4199af0c7e3458c1ee380f1577f2e13bfd1c6c5753e504de",
		"41d90c4c813e1d2ed279fdfb771b9c0e417a0badc0bd20905f04b50522ac0ddd7fcf0fa21a191bc28b6e0a01491be18be2824280871ddf4c1a6aae50ed35dcd48f3f206b389e6ffab71899b2d5371a6648dda43b505a4ff55fe0f4431f8c8ae2606eff68252628605ad4b818d88711d2128850c14316cd927a66ff2c384d8685",
		"21fb0174f0f211629e770035314780edd20554300a66e8233e884f8e3a66db226a5afe43460b411808a6704946dca9cfa7d7bd3e19e957fab58c4d56a55dff375c6deb32535c2541ac510db9b4afa41e722b91673c025702a45ed299b6056d677bba87eb0fc0365a7e6231021eef331caab85bcf40841653eb9d92fe5e15ba88",
		"46f35bfae1994ad28c873a07addf0a55b46048001902d8ff3336d8ca9bf9393b05700bafa2010a0c30a378e5a369ac43d570c8af2371287d795f4927602258076a2edb857442b5caad6ba55e2b34446a693db3b828ffd8d54efbc85c54f23a09594a2d1e4c3e867d780932d7337d514dafbd2f3e7ac47004cd1b1c084fffbe4c",
		"3ad74c2c419ca09cc039924213213bc864ba4c7b2028b7f3ea4ff5d6d2be395b3cff74ebc6dddfc5bc6f804017b662526549a4c39873674161d5b2a1a63403e4838d209c77d4f1f3a564de93a6bdae298bd503cf258ec99cbf4f56e99858bac5723b077c3342d6faebd5299f51da83b7be1d8906a9857b55e9584c74466595ed",
		"119700c55e22cd4a6f386c8acf3598b02153a6e3996e37825ad1e7ea1e9ac3144a97d9d14b0f791c0c292a8efa4d88a9a05b1b5492034bbb0c94961301a6fc413e84f68e64717772d00f1d339e741d520523d14527362c6350ec74e852d43d9f35531d2530255b92133c24d4e093b87fb092dc77a8de05e3d8e4757c5781d9eb",
		"1cee1a1edb40c601cb51047f223b542c38ecaa1b54d0b73841854cd87aa95af957380818bbfa177217d0d78b40c84e240a799775b433be67a677179bed7d611b182df5273988dd4d62508e000b8d87ce66c4021c846eaab3c495a46fd38f37a007dd79925acada612bac4cce261f4969cff329b608b96865cc246754438f1a99",
		"5bd70107157b2291cc36e888080b9aef9ee0e206db894bb093ba0f0c869ff45f5ad0c90daf71f162f2383cfbffd5a1a04c8edb91e7c6f44f5790fff87ff8cd13431f1e151c7d517f0cbd990cd225d7ef461531e48733ecf9af63a0097f6c43fe26621949f22f8377f24a97d0f832934d73f097c68c9dd3d698b550ba531ca8f5",
		"63100ca4e3a4577e57bd74e522f25308e18f7d546c57e15bc524e22916ad767c62158a3daafdfcd5be296fa81293ec619403a362a5f63ff7b5661de2940c08077d537a063520d388fad4b4310ac5a6d48f93022a14d81a681d5c2ed79f5e086728e13d618f57a24815eee3819a33a0c1bf68281a959de651c7a48f55f073494c",
		"33c231e843b163669c52281714540c1c8a383ba8f07c5a2cd7c3409eaf16a8d90ebd41f0c15f1914235e0818a7e7d6fde460da8a22f94c7425cc4af3b52362992291af5896800cbb460446dcfba29e5c9bdd3d23b4feb6dfb35b5385a747820c62a7b9e66557b2699c8cc543c6bb318b3f3020a14cd35cf05f7fdf1ec5cee370",
		"13afc65b64fb9ec4f99e6da8719bca09982c1f487594bb3d6248b5f97c637f8287ab413bb220cc57db030d44fa31233635c0316535acc0e40968beb845e6cf05833d893765b6334ab6e8658677f122d68842b55dab1aa0f86f459c85ef3f0edb449e5d7c19574dbddc215c398a48e64f6f260fa513a76e08728d0a36f139370a",
		"6f38c7543608a8e0b59f8f151d0589c1b919d939caf27a68741741312395ddbc139ab5e28b24b0e4a7bcb3e2c4cec1f91b75354760f55b5dc682bb2346b12ba656788cbe15674e3e42e7fd5d1fe5c60f8c6c1af0212c3dce88115f8a877286416ee5dc9d97b683b36f0362ccea788afb542398470a229c7cb1a30dbfa596de89",
		"80868a7aab2c93a97d85c8cb4045b10741e3c10a8f928a69b019c38163802dfe01e884a92ed12ddf89b08d8fe86f5dabcf82dac46c609e85b5d3153fd60015e216c0b489d0558dc3d0df8bd7b677b4025bbe6ab18e3790156c1040e8f755f9905e67882e8534bc3fe0175f2235e503028d835f7e9d4af1f4e9b50da950ebcbc4",
		"52d58c179b8a90138e9bea825f00304a2992814e5f0c21527c6f73c554a863328a1dce30bcbe4ada5afb0f4f08e3b43cec871916bdfa54fd87021609bc1fe4237b5f8895ae3f70354bebe2dc725411706accfc71e2972bbf50489dca2aa3d9884da34afc6580f106f4bb127c373ee3caa1b1cc0702972f14b9f3d2da61a48c22",
		"71b18e21db4eb2c5496fbc2855c09ccedda7ca1b1629bddc05b673456495b7af51e9690beaf14f5db7a6c79b03e4a54d1f4afd6e7dddde0180382705bfe79d1b3b216bb2578f46ccf05c0299d60a898e25d0aa177a6ed200e502ef3ecf17d7d22982f9c6bc219d5f7b823e8c815f09392f5c2645b8c9e18f13b0a1431444b958",
		"24fd6f4553a836ea039dc09d6aa4983528df90f18e29c769ade70ab63d493a8d1e5d152016e0e2e58ff6001c20bdb13506d680f84479e764e2801e0a8be6789b1315765d6af3d8a589670de25a70f1feddb137d40c018cde8900aa1cc3fbe2d908c99ed0b2a0b0a6948f5e5ce38a47a3b5eab3ab7b95edbf81061edde8e1e361",
		"2ee86037f333eb78611b2786cbbd233c4bc859bb0f1cfcaefe66fea25b08fffe2a73a30afa36dccb5c8739d4c43140d383a32f55baba873a15a6d43c0737113653fe5a56d998d1fa63842b90da69130cafce8f89162a84680c807b4307631af32cb87cb2424afc9b70aaf16839d1f5fccd32ac387121a6ca73e1aeb13bf50d36",
		"5510527b5440b3a8885c4b299d003ee6ea763589dca284f354ab181875e9354c1a5b79190bdaebde49f03678232129ab9d67f541bf1c6f3cd7048630c7e5bf464e8f3823e589db46b1cb9063418f5d545a443f76a2e315d987db1d6c973ae0e23f875329e95a916d4fb1c0de3397fead8c106461e16877259f592daf4ec3d692",
		"49eaf3f1a26f75081b6c5c26259c6203a297136d1909679ade608efd0bec9cf04a3bab9686844e1175c757bb5c5f1210734d95c75d2285aac90cea25f2e784b8585712cdd3efb4275e19ec30185d6dd56b109df68cd9aa0f995a86b9473ba0ac7fab0ebac2dacfe06df8c77292c41a78ba4b1b7527130c7d647abf71c00eff6a",
		"5ed5c70828239c6c3303f58081d88aca72b10c3f185d4d2c4ba6ebb6064465fd5cb7d87eac4737a2526150d29093453c4b5641e557763ee784f5134d75fdacfe6633497024790eb65399ec132b57a3824c7ad4d08f5c7221b2412cf45d47a9967549a0e32d7194bc6fb869bb413008653de881f538ac3f75c11a7b51466e8743",
		"787895d332de532b59daff77d0a4f1a546a5f261e0484fb1a73b78cfadb719590d5f3e509db27d6d399074540342507f61c32c8f6211601e8e20c98ba7ad27f407a5e2892f0b59b973b8420f259abf279aca358a2b20f7b3fae43be686e523e869d071cb6f14f886afee995cbd8704760769ecc934901adc770ee3b980fd51e8",
		"18cfd2d6f9f8c72e22e7a00321a101cb33e548695efa46b297789096f2b8f6a62a9a88d4aa9f75d7e58f69cfb13eea87e1f5cad0fa06c7a2e1aad6109cede0884f3c34c4e226d154505077b3ac7902c0f93288bf5c63b0d8c955329f05df07564745b680bea0f5f8317b33bab208ee58ce8218c73e518c1be6c6250ac7266f6f",
		"2aab25371a657d73c5b700c9adf63266f390fb1023da3cae05c26438a490be370e44698c1ccfdfa979f2e9906dad2d67885d4c7331253e0a2aec9e8d545186e7425e60e761c132f10cca3e58ae7e02be09d3a793435a4328eaab38db965f255659c4380b9c6d72cb912d7a057db1476265c2626dff5c28f8f53ec57f3b03cb6f",
		"80b14806aeccd8c2841468701e3b48bf51a1eabef87f55889e2ea7ef4b0b463171c7921b8dfba276d6bb4d3ac80f8ae0b6b762c24d9b9e5f78002ea66cd0e3c91e3ed4b863f09c9bd46b31a84489fb32bcc9f7782106563ab9df58c35a88ef164372009fff5d5499939dcd3394193a35ce264efd633ffd9ac2e7a3e8cd21e42f",
		"2fb1e3a5874f27d4f20477c4b7f4eb2b17fe029d0220c99641ec2562c0aebac458f3122e647ad16f933843f36b040574a51975f0ecf89e171359c7f2ea4d5be4284b600bfec487d095c1ecf0347151257b798f2ef1eb35f953d65575897bed50085b16fd48dab8db617b65f356d954b61ed60a77a252eebcf64c673769994a0a",
	}
)

// 定义用于存储的密钥结构
type KeyPair struct {
	PublicKey  []byte
	PrivateKey []byte
}

// GenerateAndStoreKeyPairs 生成 n 对密钥对并将它们存储到一个文件中
func GenerateAndStoreKeyPairs(filename string, n int) error {
	var keyPairs []KeyPair

	for i := 0; i < n; i++ {
		privateKey, publicKey := bdn.NewKeyPair(suite, suite.RandomStream())

		// 将密钥序列化为字节
		pubKeyBytes, err := publicKey.MarshalBinary()
		if err != nil {
			return err
		}

		privKeyBytes, err := privateKey.MarshalBinary()
		if err != nil {
			return err
		}

		keyPairs = append(keyPairs, KeyPair{
			PublicKey:  pubKeyBytes,
			PrivateKey: privKeyBytes,
		})
	}

	// 写入文件
	file, err := os.Create(filename)
	if err != nil {
		return err
	}
	defer file.Close()

	encoder := json.NewEncoder(file)
	err = encoder.Encode(keyPairs)
	if err != nil {
		return err
	}

	return nil
}

func LoadKeyPairs(filename string) ([]KeyPair, error) {
	file, err := os.Open(filename)
	if err != nil {
		return nil, err
	}
	defer file.Close()

	var keyPairs []KeyPair
	decoder := json.NewDecoder(file)
	err = decoder.Decode(&keyPairs)
	if err != nil {
		return nil, err
	}

	return keyPairs, nil
}

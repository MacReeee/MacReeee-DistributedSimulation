package cryp

import (
	"encoding/json"
	"go.dedis.ch/kyber/v3/pairing"
	"os"

	"go.dedis.ch/kyber/v3/sign/bdn"
)

var (
	suite = pairing.NewSuiteBn256()
	sks   = []string{
		"436babacceaa0e985ce0b06321e50db789a5f9230b5ef3ffddc8ba64d2c896b8",
		"07ba027c422e35ac0b14794f858e924481e873fcb1771f9357e84055d37f580c",
		"80895cd18284111cb38a813c48b8533168b9adefe3ca5f8348261143391a5440",
		"7e079446464688b9f429ee9e6552e127ec413e3edffab7253b1475f7d79a7dc3",
		"6cdda21fb459d22b1616ebff6b90bbc3dc06303d4e9b20cf6f2c843947b340fd",
		"879a78528c8268ee4d4d230620bd74c34fd8568cfaffac15b2cbf30999994b1a",
		"63870376137ff9d1a81fdebc97585afec5c69d89b8171150919bea0e8a86f6c8",
		"2d8ee8b85557b1fd3796411f8c967245c6a5b42725aee9daac864cabe048c929",
		"1fee201786d30274c019dd49c469f532681336179932a278c58c31cca3513373",
		"1bd5284a44bcb26aed34846cf7173eb7093e5d633b5513006cc9bd76928ce500",
		"8f90f25a9030008b6a27acc41e09ac9d5ebcf4b1042ccc3cdcb2d2d0965ab52a",
		"13e25125571824351f15d4a07e021a29ab7c8de87e9827da3f2afdc0708b9609",
		"0c923014eed2dfaf1cfb6324c40a92f5f3cbc5105b14a79c0a00140ca832753c",
		"22cf71fff8fd3659734bad16b34ef4fa6275378f83d7f85d402cf8a121b91fe5",
		"06de6271becfe8e1dbae1bf36d2fd620d09776331216cd65302d67155efdf112",
		"6c41014fb2a121ae1f8f8684d19a4d072b0443161491070496469a27f246d9bf",
		"24281dc281242ac22358de96d4cccd43458c4e2fd43eda5f302930306e670bc4",
		"8d6e80872cb4eaa020fd72f7bb4d74589426c75b81c518128c0040cc4412e951",
		"40f0bfebc4d4eb2d1384184696d9c44896fc9414c611f2cae0e4d31c823f8c19",
		"634833eee9db2df75ac6ab4bf0e647107eb0453e0450eccde64be7bd969a5580",
		"05e307400417132a2f64e46512a81367c3a531c43557e34ea581df75aaa7005f",
		"4953f106407a18dd328916eb2f1ce78f77eb7f8f0c1189f5fc213227aeb4a7fb",
		"1a830ef334e0b63a1bc0ee6b615ac25efdf5a9cbb5716ea22be2cc781efff7f3",
		"61de671b91d6240822edbe6f58ed12d5f9d2b3c45d2a8cd371f18594d5fd65a8",
		"42fecf526ac7a11b805ba5f4568a181dea87f4784e319c4c140e57c22dc3db87",
		"6caa7d42b33d602cb970f42bec8424164fadf4b1a622fb036382a70bebea89df",
		"0ddc53e3ec28a7926445030b4e6598ca30834633f147b4d308396cad6c856898",
		"16e77ace6c1131619e0358e811079568afb1552f97ba684fb865c423d617f94c",
		"14852118b81ed0a9c0f8bffd2bae185ed94a9655483e0f61d8556c26afc73719",
		"202708ac9cdcc51d4d282edd13859f5f4188d9e8b61783ddf4253acd4adf7cd0",
		"035f96ea85f47d134feeba6e47285f936db349e9f2c056c8b3b3c5238f291cb6",
		"5abc952bf3b8ceaf9b6dd7bf7e9f20105dc70b79d05819617ce45687487252a3",
		"754dffc5eed0e84c46ff839e7fa8e2021e82e0f2b840132cf23b2fcfd4ae95e5",
		"0698fdbebb92b53fa9131ea0bb7ddfe02678675c732881043309a505901366f7",
		"16b3ee40419c5c088c7875634bb08f07c2ca5d372bd1dc6ef1611a15532b78d9",
		"1f73ea364def0e3a44a23fafd734dd516b0e2ad7a0aeaeb1a7ab80775b672994",
		"73e413d74b8b5242a13b7b6586b5a097fdb6f073dd69b51aedc231d1981497df",
		"6951dfce0c7cfbb541d79e83f14e52b157eea9eac9a618dcabc1f60191ce337b",
		"207b36044d172c0c6b80d39853c94e89eda289a99aab3123a36a5f7bb41bbc43",
		"7f4e16e9f2d68a7934faf0b710699f5c6fe5fc251dabd83ea12bf7769105d478",
	}
	pks = []string{
		"4e5bfe782aa1ddcdf6480170aa710f4ea366ed63f8b711ebf32305fb254470a7633934ce2a3647b58850823cf32da712643afde19b79d24659b5d7d3148a837a4e0fc74c919d39dfad40e41db5df66dcefcf171c26dfb73c181f176d767fa0686702e9b146bcaf2b6905bff1e25dce2078052474f742bf8c42eaf707afdcb3b7",
		"235e29bd16ad97a7ad0ebfd603fd24646720c794ac3acfb5b44fda366a1cb5b878515255f5e6c4550c8652138ab4feedbfa75c6fdd317b9b1bbafd1eae6ddac21422825a80240d787101b93f14fd37bdb63fa8cd0488032f5c87e69f115fda2e5b66422dc4d164a6ff9de252d40c7cca04f51228abce7ff5df40300936452dd8",
		"390d71fa7a3882048041b3d4d96cfb570c0f844b1df3bd3e73115d969e09a42f6d09ffafe980b37b1b1cc976793813f9ea23e82f8000e5badd05d6e66f65631e30793cd8930af7c20909a94e82b190dff7bd5898ee6b864383991e888db9c08b5e8b6f517f5be6e313c1a74b51fabfb1e77cf65ea9e3ed9a834cdeaa101479f6",
		"1118bd064e4f8c40669afa951d8293e2f4a14e12f02a229b6b40f21bb82853d4087dbc712c1a2e22a4047e0f163aa6fb5815a2e0c28ef19755832ac5bc008d4d55959029010376624a00c3ec38fc60501ee16c7bec0459b7b74bb43c3271422a33418b1bc2c7d1770215c2cf65267b7a06947a7276df773cbc81dbc2c4d80938",
		"12d432a8fe2a57ac7aceaf67519ce80ed7f2ab1f9a1811dc2e94394a20d644003affd564337a543797ccf81f49bd051551adfc19bc62f3d2e1a2c3ea32f111a707031a0a5d2f08fa77d6c77eb58e8ed0e299969691153421d3b22aabd5c340720f45dbaee16330668454913bcd62be21895b6e1f86f4dc9698c302901b4a9b87",
		"35d58aa3ff7f8ddb46e5a1c42268f23dc6298e9cbf503dc20caab97e838e186e24318ab659133de1cb82ef8f72919a249529b9f01e840daeadd27b20b9de7b766de34a660dd09a3310ad2f96cb745f723627debced780923da166b8321a6a45e86fc66e2d68408af1abd6de86b9d4c14ba3a82e75de19e14b10ddf2e6ab2b9e2",
		"06e91e4c752aff38f82750bd797e071fa08861fb35cb079b3385a58535201c0e385e683f03d7d3506170b4b594d1cfc43988debc9103002b6759cc99f0241e6850173d7a23b3b28ae76f0d15ddc9c756cbc51e7b639cb23f921c0fd9ff0e5a8654127e259e5340c877260be46165f09e7de765c7cb0fb97a726827ca940e475a",
		"8317dfe0d2a6702037a4bffe4e062e3dcd4c3b78d633d0e48bf8295c0df263293bd67139e35b8dfdeb63790c14005c2da45993811b8fdd1527ca37be3fd2298f524dbea9e94883853eb7b15f677f52156089590b82171e2d23e026ff0bdc73d64a19878c8753ce3eafef54952115b60043a7deddeb19cccb9a0e3bc469d4cfb5",
		"6ad0ecd79fa0bfab9b757ded51ff9a3b0f75751f6ffd539ceff586c8ef7a336042ed2fd900674488d2b4e88d2e4f341d0deafc290e29b1aba90e2ab7e6abc63d58815136d77f67d134dccf6b21acd45753e0d0d0b75a1cbb86dcb430dcf5b26d825ef752a570f3af07d507b60324dd4423a1e9d818826838a66828ae598a9138",
		"47be4a0c90e9277f8bdd57faa7a747c918ca6543295ef3d4d90c378dc9576cb34759d345dd5b6a33b077a11c8d53acc52a412d277c508f6d28f5d9fe80239e485313f681de7e98dfb0f0869ebda39956fe49ceb65d913ff1ae348ef2f46c41e58564e3e27c36d89b2d34196ecf5988f5fe52c9ff5116898a08a3f94695e4a9bb",
		"2341dd534bf7e70d988dde4fcc5a0e873a2fc92529d3404654a620b935073cb26cb1fdc99f84f2368dae93f2cefb78497bcaa204df5dcb220895cd3dedf9260c52c72cf0d5077bbfbbd38702ce0893615944522ad4160060e1e8e75e6d19163987e4200c977d007b7148991456340d97117a67809e3eb469e54b52e1b883a255",
		"46a55224c6fbec323adb986223b49d8ba7dea49eef9d84fe37693f1b497270d6866fc1c87be307829b460c077443325b27b24a93abc5e4fe626e89e7e7e0b0f24e889597cbdbaec42394cc817b47b9f0881b5621d09d272765b8b458a0a2a16d182858e148b02c82734893d58a2a64fc41ffac90398f33fa5bb060a9c220c4b1",
		"255701a988e8d6a934a3539ebe563f2e410b1db6b5b54dcf3bd068f2d4faf412715b8bc623e85c1a7214b2ddb5090a4e93df52ca730125f9ab736b2bdc4cadb60d4d764b3ea67534471c4eff5b37762ed2f56b9cb44673fdf769cfbf609d7ae82eac15e974f2edd8d96128da99374f35ccbd095986c9236d479184fc5f67ecd3",
		"38dea165b6ebd2cf031477ab7f46e22b1ef9fc6f2f94f30ab68418e3433a136134e704c29063562b872c3635b5c90d574045a48f7a964c537e7fdd92f14ec0a83474d16ff47183b3d5562379b6a5190db3037d8dcc983539f833c56f936604bd354f4cef9f57f9f3a07652de3c25bb594a87dde8e3d8ba86407c2621f7d76316",
		"7d74038160c457e0a1e81f92af880090eb6b348ef6838758bffe49599e11cc821e8589c5a0c9bf8c22419df25bf3dda816a3aa8d239f38c6b5c422064295c9ea87b1e588fbb07e5cd5529ccdfd46384d80c4242b5798df946f7a14969f353b604de321e91ced5d14827cc7a580dbfb31f28c1bdcf6520f029b98a3511e6e388e",
		"31a0b52d4a88f1bc4afde71814957a66e330870eba2be665edc850cab5e4a966605d5cf5da990d244e34176111e2294672d403c3fff911abe0fc6bcdc53bb650805c1ba97674c2f184adb7ccf2438fb412c4c439f5796fb1906fac4ddbd6efc64aeddcd85ae130256e9bc5a1bd0b3e2e71dc9d5989220fcea9d2e5021893bf57",
		"02578e0c435a9191462c52cbd823531a7af65ceda5a41f323d510de209b3fa3589c842c7c0ac5f40ca299c77438fe9ea4fc1a3526605c6150fbd3def81ca4b6243c83af95099325bfa594b98831805ee87a4a1e08d17990512ad781f939265114bd1ada950aaa9377f592590122cf5c745de35fc096de58eb2479941a6a55f0a",
		"530e4e1d1394ccf7fc6b85dbb2a74834ebf3c485f6da63ef89e8cb2d7e4bd84d261034c2f3aa9615548737a9a00aed11ff2cb477d0b7d5c4ded0d44b1a2460760b2c32490009908b994806e559991dd6050058ccb5c913ce45d7bc379bf6dc19814df157e3a87d679c42bbb0b336ee44e4fb4e9bc5af030281c8c46f067ef8a9",
		"47b621532149bbb3d8bf2ac8c5a16e16b25ec30e4013885e71d93063735f3895225173dd718e379f24edf3e20593c620b5bafdab2da107869532c5ba6b2977a4066a3a3af8a75c7bb169159806fbcb82b805631d4b207d24d709eb7cdb39d8e73170b6eace55bb184aeb65dbe5090b58e13e7614ef4ff819e8497d0d36818bca",
		"454fbb5b888b594e72754a543a3c68bfa7b64ad25fa42cfb8703f8b7b593764f031f7b428e3eef7dbb8f483d1ac5dd336f02c520313d738b875141239629b07e06a5aa82f200bff232dc7d6b4807678d95d9a3543734733b11b80f5fef35c6ff308d6451c1408f311a3962bf59bec95c2d9c9b3f5ce98bbe3147410a1dbc9db1",
		"794e3e584a20de301882aed92ed55284c76bc7b060a07a745bcf5545088a2a59758735ceeda9f40bc688095e7f35d33f843571af1a1addf4e751077319b9b4b1277cc43fcac711ca5434e45e4f1072b1262c7287f1818589d7cde676e8ff5e328a5a4113741970630c9f97e7a2833029af6a45058869d4ecf24687fa6c6511f9",
		"04c137098704e3b4071e129e6f7b0e2fdcea988837a36ded4bfb3c877ee21bd36978021d179cd98e450d153d8f64e1c7627e25d6e18470143fd2e5da5f0a993c861223021d3690c7dcf591e2829d0fc2d4e0a27ea90650241a7aa18e1a8a82b844b558d0bb5197c3d1b63d6d484105923760fd73d7d5d626d888e045feeb48a9",
		"7f5f8f51e8e599eade8f7463f261d8cf6b1c5c979b2ba6712638c5adecdbdf0536967c8492be304ded788ed66cd6736c42600bf9eb637069d82e106ddb19f76c425553a61a276abdcc9db131a74771601e36b5b037bb1df98ff2d7abdbf6aee72b2f56e1267fc547bedb3f29748ab28cb9f4f49f709f03fa95ec53840c4bce01",
		"39a82cb5e0334920b294b5e41a3db8b22a2a69fa8258a58c6c8a5a830f1e26d4361c5a27dd84b8ecf0edbcee0c4734178fb516f77b41f07e2b34a6e43bfe00300f393b1933b5befd20b10c6739a9b17d77a537585d235f36358098317290f41f21abb4291435fce7e7e6fa325164810fc199fec03949c19e59fe52e6c34d3cfb",
		"026958e13feed21eb0261e256e1ef1da7f4f2b1e6dd7884c17eceefd33bf559c4ee086dceb4531a033f9e10034dbd38b126177e024ad70a9b1eefbbb06f454c32a0d56d028726337a6e99e8eac1b4024a21219e7cce91db1484f576ceefcf09b5759633ab21e3b8a666f5220d311f6755f13bd9c5bffade431ae22839e9ff424",
		"052107ad72d6ce7304655e994cb8b7c201ed13fa2f7e4d1d3812060d1b4299c5013c155b2abf46b22f041df631ec50c7a1e9588c5a43784f44a8e60c398a0c3441954be39907bc35b1fd7156f19276222da936ea89aa1f9d4b7e6379aeeee27239beff9a1f366de7d7e9a949b67449fecc2245a9e11a668e4615a5f425c8f726",
		"7f99827419d3fd46e925de58703e5fed389c98d9858e6bdc0d084e98372498187ef7f0a3a3871646114a6c2b64001ede473889949bbcad156385dd085f38bd250ca73ba66129674d2e89665290e18321456efcaea06da618e844240bf051f13641c0ba42eb81b803874c65ac86100cb588fd9f93541bfa0129d206b0291deb08",
		"2f3311a590e5f01593bd7194927f750ff5370d817e4532d5d5a4e3c58e07ec2146e6e68329aa944f39495cf86e71a6325940773179cfd325cf028c9777a5137b352987652a30349c6a9335b306a6955150b89a71879b7fdb6ca9143f2c77f81d0b7599126c8feddbd9e5aed0907e8095d4427deb1761443838f753b7afbe4957",
		"1d66d9978bb3ead96434fcf00fdbad80e66e039a7f720fb322d663148f6ccc5512cc51b11bf7093f2c2e60374f5fe404b58d83e8d9d24c519eb0ae6b75ada76a1fb14fec7cb3b2df195350dcd483ed888baa8d82479c35fce36721ebe89467be1e0cba048754de720f42c286158da3e3fe437efa9676888a24bbf4bfb684759b",
		"31bf920c81f13b07b35a905cbb34ca5fe8dedf569ae157c26e4f8367ea33bd5e08cd1149fa6aef1ac6add5b06502976bf988a4b6f5b9cef270d3c6647a4f36b87b909c5aec5b3f9cf044a9fe60ec0ce0762d491d6cb74a62a339041873b73023584d7378fc9e5757650bea2c857fd23aad0d5a383828e00dfea475ebbbeec727",
		"8b68a215aa4dd6f5cf58e9c5abc15ec62d35ee9c9c7fa5233266f4c7a18f195502692913e4fbf7babee7c2c8b695211d7334c1f082cb512609ec08989b9c229f3f821113bd04c1bec41fabe72571c04404cce2d5556d68d86633972f7b7a1a4f8e3a2e20872168484cc0fa49cf15ae4c92b5c376437cb04572c29268888912f1",
		"8b606dfc855b3881eb561eda4b54292b50f3c7e40a9247df2d61f2ce5f241c010d73e7483c3f358c77dd814b23c11a4f90f9a71a2bc2f657ceb6566220160181064e76829643e84fad5704276468de4f6354805b5b4afa92d7ccffeef3069c2c1a6bdc36ffece5acdbf061ba55c22d2c4ef2876bcad59133eb5bdf17bec84182",
		"151e3a1a294916b02cb3babb0c4698df1572de5d1b6e79fc37f093e33c8244a96754802854ade7f189a72746a50732ea3fd858cf7de2009f20091540b76e7e96621da1062de12609b70d141ff4e5f638ee912edff37039b569258ed11bc0163419f1d66576f09457d985473967d48b8b6b099d0453ea524defee026fdee91e7f",
		"7557749f8a12a29956add81908ce0534c5da86689218a5ff4cdcba319adef9741bc062bb018575c7fbe81c48894f0b14cca1bff1e35bd5baca7c8f0b0cb569815fbc8931e6901e925f0cee8a081a8e024a486c0770e1a627b36ff9ccd5be4e8a064adbb0b868d8625a20c28333aaa086c2a41d2d3e1857b1d469fa8d210361ee",
		"65672ad5f2a925a122c44f66d10807013c5c8a23a654ef1cf892cc43a422be7d2e9fe0513f0a984ea4ffd20d53578cddcaf1b88f4ec168f3d17d62570c59195c7cd94080f1ac9c01884fd013644fc29fbb82cd8c99d5f559e4f02d814450d36b19c0af807b78f54e509bc31c176eef7e0a5b6f80b5301afdb07ddab4c3eb13d3",
		"05f44e0b58a135bc40d51881aad5af5e43977ef0af8d36b52275709ec325b0584c5623c2f7929b9fe2526bb5ec45f7c9fb11a32dc17abeaabce7c05eacfb94f56a67cda0ad5dd1541ffaf56c6513189c2fdff3effd894518b8b0ab81186015de5ef8c956552b59b8784fb88eb6a3e26e317f02bd58426bb815c5d0a319d8573f",
		"65094b65a2f4e9d15241a4f609330421235d9ebba953fff289b019d420f9b7c5022c78bdc3ee6250912d6a3f29b76436d179ac4f0e5462583c2e05447519d157267bba3d991ed4d694895c5729faa390337a565b89969c5d94a55bf9301cebe52cf90341f1e93d555b2d34c37b6cf4bb3d2f7cccbc7b2cc8c54011a4275e1d5a",
		"39596202ae4acb109ef9d6caa5593154e2176cd9943ceafa68cc3fd9bd725b8817f75ba3bbe7d6be74eecfc4e80ac6c6f3a208fa4e288cb51d7a5285c17199ee643f5fdee7bf2b69cb166ddd1ab80f8a0622c920a05ed8134c98085dd19b633a5bd8337ec95f77fc77da45753e23567e31e4422677ef0c4bfc82b73a50a35966",
		"516f9c10416757ef06fc2c1f4307677bff552abdadc6cab799dd04cfe034339b2e9875a227a5c77be22856f6ede95fd693a46c75cf975a282f9e7000d13298e229af36bb88d203b0da659e2151451b924c9c5afbb8f3159d4d2ae46bd26cd7de6f5347ac06c776a33568649820b4430d00455f1f1f9e16e769d489779d0fc1c5",
		"1c4be760ad4760e0865d538ab51aad3cc8f155984e1cbb4898fff9341d09e57e497ff04a133bb7ddb7a2f574ff69c7cfcdfa48142d09aab7c0f799961b1d86f685aee09fc7dfbb3ef37d757ea4786943fe136dab7bfcad7f593d55ab88304bb48674ab8822f742e3b8b790c289c0436083d711e7c665d11a7d79ab06682fcd4c",
	}
)

// 定义用于存储的密钥结构
type KeyPair struct {
	PublicKey  []byte
	PrivateKey []byte
}

// GenerateAndStoreKeyPairs 生成 n 对密钥对并将它们存储到一个文件中
func GenerateAndStoreKeyPairs(filename string, n int) error {
	var keyPairs []KeyPair

	for i := 0; i < n; i++ {
		privateKey, publicKey := bdn.NewKeyPair(suite, suite.RandomStream())

		// 将密钥序列化为字节
		pubKeyBytes, err := publicKey.MarshalBinary()
		if err != nil {
			return err
		}

		privKeyBytes, err := privateKey.MarshalBinary()
		if err != nil {
			return err
		}

		keyPairs = append(keyPairs, KeyPair{
			PublicKey:  pubKeyBytes,
			PrivateKey: privKeyBytes,
		})
	}

	// 写入文件
	file, err := os.Create(filename)
	if err != nil {
		return err
	}
	defer file.Close()

	encoder := json.NewEncoder(file)
	err = encoder.Encode(keyPairs)
	if err != nil {
		return err
	}

	return nil
}

func LoadKeyPairs(filename string) ([]KeyPair, error) {
	file, err := os.Open(filename)
	if err != nil {
		return nil, err
	}
	defer file.Close()

	var keyPairs []KeyPair
	decoder := json.NewDecoder(file)
	err = decoder.Decode(&keyPairs)
	if err != nil {
		return nil, err
	}

	return keyPairs, nil
}
